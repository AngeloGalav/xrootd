/*****************************************************************************/
/*                                                                           */
/*                             exampleQueries.txt                            */
/*                                                                           */
/* (c) 2005 by the Board of Trustees of the Leland Stanford, Jr., University */
/*                            All Rights Reserved                            */
/*       Produced by Jacek Becla for Stanford University under contract      */
/*              DE-AC02-76SF00515 with the Department of Energy              */
/*****************************************************************************/

// $Id$

## count current number of users:
SELECT  count(DISTINCT userId) 
FROM    openedSessions;


## count current number of opened files
SELECT COUNT(DISTINCT pathId)
FROM   openedFiles;


## count current number of opened sessions
SELECT COUNT(*)
FROM   openedSessions;

## select #jobs/user, display top 10
SELECT userName, 
       COUNT(DISTINCT CONCAT(pId, clientHId) ) AS nJobs 
FROM   openedSessions, users 
WHERE  userId=users.id 
       GROUP BY userId 
       ORDER BY nJobs 
       DESC
       LIMIT 10;


## select # files per user, display top 10
SELECT userName, 
       COUNT(DISTINCT pathId) AS nFiles 
FROM   openedSessions, users, openedFiles 
WHERE  userId=users.id AND 
       openedSessions.id=openedFiles.sessionId 
       GROUP BY userId 
       ORDER BY nFiles 
       DESC
       LIMIT 10;


## select total duration of all the jobs run in given time period



## select total duration of all the jobs run in given time period
## for given user


## select number of closed files in given time period


## select number of closed files in given time period
## for given user


## select aver # sessions in given interval in time period >T1 and <=T2
